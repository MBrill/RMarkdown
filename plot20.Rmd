---
title: "Lösung für die Aufgabe plot20"
author: "Manfred Brill"
encoding: utf-8
output:
  html_notebook:
    highlight: pygments
    number_sections: yes
    theme: cosmo
    toc: yes
    encoding: utf-8
bibliography: literatur.bib 
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(knitr)

library(kableExtra)

suppressPackageStartupMessages(library(dplyr))
library(tidyverse)

library(plotly)

# Ausgabe von double-Werte mit  zwei Stellen hinter dem Komma
options(digits=3)
```

# Daten
Der Datensatz *mtcars* ist in der Basis-Installation von R
enthalten und enthält Angaben über Autos. Wir verzichten auf die Konvertierung in europäische Einheiten, wobei das nicht schwer wäre.

```{r daten, echo=TRUE}
daten <- mtcars %>%
  select(Verbrauch=mpg, Leistung=hp, Zylinder=cyl) 

daten$Zylinder <- as_factor(daten$Zylinder)

daten
```

# Streuungsdiagramm mit ggplot
Wir erstellen jetzt ein Streuungsdiagramm für die Merkmale
Leistung und Verbrauch. Dabei färben wir die Punkte
mit Hilfe des Merkmals Zylinder ein.

```{r ggbox, message=FALSE, echo=TRUE}
ggbox <- ggplot(daten, aes(x = Leistung, y=Verbrauch)) +
    geom_point(aes(color = Zylinder)) +
    labs(
      title="Merkmale Leistung und Verbrauch",
       x = "Leistung",
       y = "Verbrauch Miles per Gallon"
 )

ggbox
```

# Box-Plot mit ggplotly
Wir rufen einfach ggplotly auf.

```{r ggplotlybox, message=FALSE, echo=TRUE}
ggplotly(ggbox)
```

# Scatter Plots mit Plotly

```{r plboxH, results='markup', warning=FALSE}  
daten %>%
     plot_ly(x = ~Leistung,
             y = ~Verbrauch,
             color = ~Zylinder,
             mode="markers",
             type="scatter"
            ) %>%
      layout(
         title="Streuungsdiagramm für die Merkmale Leistung und Verbrauch",
         xaxis = list(title = "Leistung"),
         yaxis = list(title = "Verbrauch Miles per Gallon"),
         legend = list(orientation = "v",
                       title=list(text='<b>Anzahl Zylinder</b>'),
                       y = 0.5)
      )
```