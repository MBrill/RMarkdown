---
title: "Visualisierungen für den Iris-Datensatz"
author: "Manfred Brill"
output: 
  html_notebook:
    highlight: pygments
    number_sections: yes
    theme: cosmo
    toc: yes
  html_document: 
    fig_caption: yes
    highlight: pygments
    number_sections: yes
    theme: cosmo
    toc: yes
    toc_float: yes
bibliography: literatur.bib    
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(knitr)

library(tidyverse)
library(GGally)

library(RColorBrewer)
# MASS für die Funktion parcoord
library(MASS)
myPalette <- brewer.pal(8, "Set2")
# Ausgabe von double-Werte mit  zwei Stellen hinter dem Komma
options(digits=3)
```

# Packages
Für die Ausführung dieser Markdown-Datei benötigen
wir die folgenden Packages:

- tidyverse, insbesondere ggplot
- MASS
- GGally

# Der Datensatz *Iris*
Dieser Datensatz ist in R einfach verfügbar, im Package *datasets*, das in der Default-Installation von R enthalten ist. 

Der Datensatz enthält
5 Spalten und 150 Zeilen. Die ersten vier Spalten enthalten die Messwerte, in Spalte
5 finden wir die Angabe über die Spezies.

```{r daten, message=FALSE, echo=TRUE}
iris <- datasets::iris

# Die Spalte mit den Spezies ausschließen
iris2 <- iris[,-5]
# Die Spalte 5 enthält die Information zu den Spezies,
# wir speichern sie auf species_labels.
species_labels <- iris[,5]
# Drei Farben aus unserer Farbpalette für das Markieren der drei Spezies speichern
species_col <- myPalette[as.numeric(species_labels)]
```

# Streuungsdiagramme und ein SPLOM
Wir erzeugen einige Streuungsdiagramme, um die vier möglichen Merkmale und ihren Zusammenhang zu visualisieren.

```{r scatter0, message=FALSE, echo=TRUE}
ggplot(iris) + 
  geom_point(mapping=aes(x = Sepal.Length, 
                         y = Sepal.Width, 
                         color = Petal.Length)) +
  scale_x_continuous(breaks = seq(0.0, 8.0)) + 
  scale_color_distiller(palette="BuGn") +
  labs(
         title="Streuungsdiagramm  Datensatz Iris",
         x = "Länge des Kelchblatts",
         y = "Breite des Kelchblatts",
         color = "Länge des Kronblatts"
  )
```

```{r scatter1, message=FALSE, echo=TRUE}
ggplot(iris) + 
  geom_point(mapping=aes(x = Sepal.Length, 
                         y = Sepal.Width, 
                         color = Species)) +
  scale_x_continuous(breaks = seq(0.0, 8.0)) + 
  scale_color_brewer(palette = "Set1") +
  labs(
         title="Streuungsdiagramm  Datensatz Iris",
         x = "Länge des Kelchblatts",
         y = "Breite des Kelchblatts"
  ) 
```

```{r scatter2, message=FALSE, echo=TRUE}
petal.Plot <- ggplot(iris) + 
  geom_point(mapping=aes(x = Petal.Length, 
                         y = Petal.Width, 
                         color = Species)) +
  scale_x_continuous(breaks = seq(0.0, 8.0)) + 
  scale_color_brewer(palette = "Set1") +
  labs(
         title="Streuungsdiagramm Datensatz Iris",
         x = "Länge des Kronblatts",
         y = "Breite des Kronblatts"         
  ) 

petal.Plot
```

Wir erzeugen eine Scatterplot-Matrix für den Datensatz. 
Dazu verwenden wir die Funktion *ggpairs*
im Package *GGally*, einer Erweiterung von *ggplot*.

```{r scatterSPLOM, message=FALSE, echo=TRUE}
ggpairs(iris,
        columns=1:4,
        title="Scatterplot-Matrix für den Datensatz Iris",
        aes(color = Species),
        legend = c(2,1),
        diag = "blank",
        upper = "blank")
```

# Parallele Koordinaten mit *parcoord*
Das Package *MASS* enthält eine Funktion für die Visualisierung mit parallelen Koordinaten. Wir verwenden diese Funktion und erstellen eine grafische Darstellung
für den Iris-Datensatz. Auch hier ist gut zu erkennen, dass wir Iris Setosa
gut von den anderen Spezies abtrennen können.

```{r pc, message=FALSE, echo=TRUE}
par(las = 1, mar = c(5.5, 5, 4, 2) + 0.1, cex = .8)
parcoord(iris2, col = species_col, var.label = TRUE, lwd = 2,
         main="Parallele Koordinaten der Iris-Daten")

# Eine Legende
par(xpd = TRUE)
legend(x = 1.75, y = -.25, cex = 1,
      legend = as.character(levels(species_labels)),
      fill = unique(species_col), horiz = TRUE)
par(xpd = NA)

parcoord(iris2, col = species_col, var.label = TRUE, lwd = 2,
         main="Parallele Koordinaten der Iris-Daten")
par(xpd = TRUE)
legend(x = 1.75, y = -.25, cex = 1,
      legend = as.character(levels(species_labels)),
      fill = unique(species_col), horiz = TRUE)
par(xpd = NA)

png(file="images/irisPC.png",
    units = "cm", width=16, height=9, res=300)
par(las = 1, mar = c(5.5, 5, 4, 2) + 0.1, cex = .8)
parcoord(iris2, col = species_col, var.label = TRUE, lwd = 2,
         main="Parallele Koordinaten der Iris-Daten")
par(xpd = TRUE)
legend(x = 1.75, y = -.25, cex = 1,
      legend = as.character(levels(species_labels)),
      fill = unique(species_col), horiz = TRUE)
par(xpd = NA)
dev.off()
```


